<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Customer Dashboard - AutoCare Pro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #222;
            color: #fff;
            padding-top: 70px;
            margin-bottom: 70px;
        }
        .navbar-dark {
            background-color: #333;
        }
        .footer-fixed {
            position: fixed;
            left: 0;
            bottom: 0;
            width: 100%;
            z-index: 999;
            background-color: #222;
            padding: 15px 0;
        }
        .box-cards {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 40px;
        }
        .card-box {
            background: #333;
            border-radius: 18px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.5);
            padding: 30px 25px 15px;
            text-align: center;
            cursor: pointer;
            min-width: 220px;
            transition: background 0.2s, color 0.2s;
            color: #fff;
        }
        .card-box:hover, .card-box.active {
            background: #1a1a1a;
            color: #4db6e6;
        }
        .card-box i {
            font-size: 2em;
            margin-bottom: 12px;
        }
        .form-section {
            max-width: 480px;
            margin: 0 auto 40px;
            padding: 30px 40px;
            border-radius: 12px;
            background: #333;
            box-shadow: 0 4px 20px rgba(0,0,0,0.7);
            display: none;
        }
        .form-section.active {
            display: block;
        }
        .welcome {
            text-align: center;
            margin-bottom: 25px;
        }
        /* Table adjusted for dark */
        .table-dark th, .table-dark td {
            color: #fff;
        }
    </style>
</head>
<body>
<nav class="navbar navbar-dark fixed-top">
    <div class="container-fluid">
        <a class="navbar-brand" th:href="@{/}">AutoCare Pro</a>
        <form th:action="@{/logout}" method="post">
            <button class="btn btn-outline-light" type="submit">Logout</button>
        </form>
    </div>
</nav>

<div class="container">
    <div class="welcome">
        <h2>Welcome, <span th:text="${username}">Customer</span></h2>
    </div>

    <div class="box-cards">
        <div class="card-box" id="showAddCar" onclick="showSection('addCar')">
            <i class="fa fa-car"></i>
            <div>Add a Car</div>
        </div>
        <div class="card-box" id="showRequestService" onclick="showSection('requestService')">
            <i class="fa fa-tools"></i>
            <div>Request a Service</div>
        </div>
        <div class="card-box" id="showChangePassword" onclick="showSection('changePassword')">
            <i class="fa fa-key"></i>
            <div>Change Password</div>
        </div>
    </div>

    <!-- Add Car Form -->
    <section id="addCarSection" class="form-section">
        <h3>Add a Car</h3>
        <form th:action="@{/customer/add-car}" method="post">
            <div class="mb-3">
                <label class="form-label">Car Type</label>
                <select name="carType" class="form-select" required>
                    <option value="" disabled selected>Select car type</option>
                    <option value="Sedan">Sedan</option>
                    <option value="SUV">SUV</option>
                    <option value="Electric">Electric</option>
                    <option value="Truck">Truck</option>
                </select>
            </div>
            <div class="mb-3">
                <label class="form-label">Car Model</label>
                <input type="text" name="model" class="form-control" placeholder="e.g., Alto, Mustang" required />
            </div>
            <div class="mb-3">
                <label class="form-label">Registration Number</label>
                <input type="text" name="registrationNumber" placeholder="AB12XY3456" class="form-control" required />
            </div>
            <button type="submit" class="btn btn-primary w-100">Add Car</button>
        </form>
    </section>

    <!-- Request Service Form -->
    <section id="requestServiceSection" class="form-section">
        <h3>Request a Service</h3>
        <form th:action="@{/customer/request-service}" method="post">
            <div class="mb-3">
                <label class="form-label">Select Car</label>
                <select name="carId" class="form-select" required>
                    <option value="" disabled selected>Select your car</option>
                    <option th:each="car : ${cars}" th:value="${car.id}" th:text="${car.carType} + ' - ' + ${car.registrationNumber}"></option>
                </select>
            </div>
            <div class="mb-3">
                <label class="form-label">Select Service</label>
                <select name="serviceType" class="form-select" required>
                    <option value="" disabled selected>Select a service</option>
                    <option>Oil Change</option>
                    <option>Brake Service</option>
                    <option>Premium Car Wash</option>
                    <option>Engine Diagnostics</option>
                </select>
            </div>
            <button type="submit" class="btn btn-success w-100">Submit Request</button>
        </form>
    </section>

    <!-- Change Password Form -->
    <section id="changePasswordSection" class="form-section">
        <h3>Change Password</h3>
        <form th:action="@{/customer/change-password}" method="post">
            <div class="mb-3">
                <input type="password" name="oldPassword" class="form-control" placeholder="Old Password" required />
            </div>
            <div class="mb-3">
                <input type="password" name="newPassword" class="form-control" placeholder="New Password" required />
            </div>
            <button type="submit" class="btn btn-warning w-100">Change Password</button>
        </form>
        <div>
            <div th:if="${passwordError}" class="alert alert-danger" th:text="${passwordError}"></div>
            <div th:if="${passwordSuccess}" class="alert alert-success" th:text="${passwordSuccess}"></div>
        </div>
    </section>

    <!-- Service Requests Table -->
    <div class="service-request-section mt-5">
        <h4>Your Service Requests</h4>
        <table class="table table-striped table-dark">
            <thead>
            <tr>
                <th>ID</th>
                <th>Car</th>
                <th>Service</th>
                <th>Status</th>
                <th>Requested On</th>
                <th>Admin Comment</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="req : ${requests}">
                <td th:text="${req.id}"></td>
                <td th:text="${req.car != null ? req.car.carType + ' - ' + req.car.registrationNumber : 'N/A'}"></td>
                <td th:text="${req.serviceType}"></td>
                <td th:text="${req.status}"></td>
                <td th:text="${#temporals.format(req.requestDate, 'dd-MM-yyyy HH:mm')}"></td>
                <td th:text="${req.adminComment}"></td>
            </tr>
            </tbody>
        </table>
    </div>

</div>

<footer class="footer-fixed text-center text-light">
    <div>Â© 2025 AutoCare Pro</div>
    <div class="mt-2">
        <a href="https://facebook.com" target="_blank" class="text-light me-3"><i class="fab fa-facebook-f"></i></a>
        <a href="https://twitter.com" target="_blank" class="text-light me-3"><i class="fab fa-twitter"></i></a>
        <a href="https://instagram.com" target="_blank" class="text-light"><i class="fab fa-instagram"></i></a>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    function showSection(section) {
        const sections = ['addCarSection', 'requestServiceSection', 'changePasswordSection'];
        const cards = ['showAddCar', 'showRequestService', 'showChangePassword'];
        sections.forEach(id => document.getElementById(id).classList.remove('active'));
        cards.forEach(id => document.getElementById(id).classList.remove('active'));
        document.getElementById(section + 'Section').classList.add('active');
        // If you want to add active class to card as well,
        // you can map sections to card IDs, or modify accordingly
    }
    window.onload = function() {
        showSection('addCar'); // Show Add Car form by default
    }
</script>
</body>
</html>
